"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/session";
exports.ids = ["pages/api/session"];
exports.modules = {

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "nedb":
/*!***********************!*\
  !*** external "nedb" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("nedb");

/***/ }),

/***/ "(api)/./db.js":
/*!***************!*\
  !*** ./db.js ***!
  \***************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"db\": () => (/* binding */ db),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var nedb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nedb */ \"nedb\");\n/* harmony import */ var nedb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(nedb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst db = {\n    users: new (nedb__WEBPACK_IMPORTED_MODULE_0___default())({\n        filename: './data/users.db',\n        autoload: true\n    })\n};\ndb.users.ensureIndex({\n    fieldName: 'username',\n    unique: true\n});\nconst videos = [\n    {\n        id: 'b273eff9-b963-49f1-923e-4a7d01f26d29',\n        url: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ'\n    },\n    {\n        id: '9d4adbbe-84c1-4e2a-929d-9904dfca9c44',\n        url: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ'\n    }, \n];\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    videos\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9kYi5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTRCO0FBRXJCLEtBQUssQ0FBQ0MsRUFBRSxHQUFHLENBQUM7SUFDakJDLEtBQUssRUFBRSxHQUFHLENBQUNGLDZDQUFTLENBQUMsQ0FBQztRQUFDRyxRQUFRLEVBQUUsQ0FBaUI7UUFBRUMsUUFBUSxFQUFFLElBQUk7SUFBQyxDQUFDO0FBQ3RFLENBQUM7QUFDREgsRUFBRSxDQUFDQyxLQUFLLENBQUNHLFdBQVcsQ0FBQyxDQUFDO0lBQUNDLFNBQVMsRUFBRSxDQUFVO0lBQUVDLE1BQU0sRUFBRSxJQUFJO0FBQUMsQ0FBQztBQUU1RCxLQUFLLENBQUNDLE1BQU0sR0FBRyxDQUFDO0lBQ2QsQ0FBQztRQUNDQyxFQUFFLEVBQUUsQ0FBc0M7UUFDMUNDLEdBQUcsRUFBRSxDQUE2QztJQUNwRCxDQUFDO0lBQ0QsQ0FBQztRQUNDRCxFQUFFLEVBQUUsQ0FBc0M7UUFDMUNDLEdBQUcsRUFBRSxDQUE2QztJQUNwRCxDQUFDO0FBQ0gsQ0FBQztBQUdELGlFQUFlLENBQUM7SUFDZEYsTUFBTTtBQUNSLENBQUMsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2N1cnNvMDMtbmV4dGpzLWJhY2svLi9kYi5qcz81NjY1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEYXRhc3RvcmUgZnJvbSAnbmVkYic7XHJcblxyXG5leHBvcnQgY29uc3QgZGIgPSB7XHJcbiAgdXNlcnM6IG5ldyBEYXRhc3RvcmUoeyBmaWxlbmFtZTogJy4vZGF0YS91c2Vycy5kYicsIGF1dG9sb2FkOiB0cnVlIH0pLFxyXG59O1xyXG5kYi51c2Vycy5lbnN1cmVJbmRleCh7IGZpZWxkTmFtZTogJ3VzZXJuYW1lJywgdW5pcXVlOiB0cnVlIH0pO1xyXG5cclxuY29uc3QgdmlkZW9zID0gW1xyXG4gIHtcclxuICAgIGlkOiAnYjI3M2VmZjktYjk2My00OWYxLTkyM2UtNGE3ZDAxZjI2ZDI5JyxcclxuICAgIHVybDogJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9ZFF3NHc5V2dYY1EnLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICc5ZDRhZGJiZS04NGMxLTRlMmEtOTI5ZC05OTA0ZGZjYTljNDQnLFxyXG4gICAgdXJsOiAnaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1kUXc0dzlXZ1hjUScsXHJcbiAgfSxcclxuXVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICB2aWRlb3MsXHJcbn07XHJcbiJdLCJuYW1lcyI6WyJEYXRhc3RvcmUiLCJkYiIsInVzZXJzIiwiZmlsZW5hbWUiLCJhdXRvbG9hZCIsImVuc3VyZUluZGV4IiwiZmllbGROYW1lIiwidW5pcXVlIiwidmlkZW9zIiwiaWQiLCJ1cmwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./db.js\n");

/***/ }),

/***/ "(api)/./pages/api/session.js":
/*!******************************!*\
  !*** ./pages/api/session.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handle)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../db */ \"(api)/./db.js\");\n/* harmony import */ var _src_services_authService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../src/services/authService */ \"(api)/./src/services/authService.js\");\n/* harmony import */ var _src_utils_getTokenFromHeaders__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../src/utils/getTokenFromHeaders */ \"(api)/./src/utils/getTokenFromHeaders.js\");\n\n\n\nconst sessionController = {\n    async getSession (req, res) {\n        const token = (0,_src_utils_getTokenFromHeaders__WEBPACK_IMPORTED_MODULE_2__.getTokenFromHeaders)(req);\n        if (!token) return res.status(401).json({\n            error: {\n                status: 401,\n                message: 'You don\\'t have credentials'\n            }\n        });\n        try {\n            await _src_services_authService__WEBPACK_IMPORTED_MODULE_1__.authService.validateAccessToken(token);\n            const decodedToken = await _src_services_authService__WEBPACK_IMPORTED_MODULE_1__.authService.decodeToken(token);\n            _db__WEBPACK_IMPORTED_MODULE_0__.db.users.findOne({\n                _id: decodedToken.sub\n            }, function(err, user) {\n                if (err || user === null) {\n                    res.status(401).json({\n                        error: {\n                            status: 401,\n                            message: 'Invalid access token, please login again.'\n                        }\n                    });\n                }\n                res.status(200).json({\n                    data: {\n                        user: {\n                            username: user.username,\n                            email: user.email\n                        },\n                        id: decodedToken.sub,\n                        roles: decodedToken.roles\n                    }\n                });\n            });\n        } catch (err) {\n            res.status(401).json({\n                status: 401,\n                message: 'Your access token is not valid, so you are not able to get a session.'\n            });\n        }\n    }\n};\nconst controllerBy = {\n    GET: sessionController.getSession,\n    OPTIONS: (_, res)=>res.send('OK')\n};\n/**\r\n * @swagger\r\n * /api/session:\r\n *   get:\r\n *     summary: Returns a session for one specific user\r\n *     parameters: \r\n *        - in: header\r\n *          name: x-authorization\r\n *          schema:\r\n *            type: string\r\n *            description: You have to login first to get a session.\r\n *            default: access_token\r\n *          required: true\r\n *     responses:\r\n *       200:\r\n *         description: Session returned with success\r\n *       401:\r\n *         description: You are not authorized to get a session\r\n */ function handle(req, res) {\n    if (controllerBy[req.method]) return controllerBy[req.method](req, res);\n    res.status(404).json({\n        status: 404,\n        message: 'Not Found'\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc2Vzc2lvbi5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTZCO0FBQytCO0FBQ2E7QUFFekUsS0FBSyxDQUFDRyxpQkFBaUIsR0FBRyxDQUFDO1VBQ25CQyxVQUFVLEVBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFLENBQUM7UUFDMUIsS0FBSyxDQUFDQyxLQUFLLEdBQUdMLG1GQUFtQixDQUFDRyxHQUFHO1FBRXJDLEVBQUUsR0FBRUUsS0FBSyxFQUFFLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDRSxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztZQUFDQyxLQUFLLEVBQUUsQ0FBQztnQkFBQ0YsTUFBTSxFQUFFLEdBQUc7Z0JBQUVHLE9BQU8sRUFBRSxDQUE2QjtZQUFDLENBQUM7UUFBQyxDQUFDO1FBRXpHLEdBQUcsQ0FBQyxDQUFDO1lBQ0gsS0FBSyxDQUFDVixzRkFBK0IsQ0FBQ00sS0FBSztZQUMzQyxLQUFLLENBQUNNLFlBQVksR0FBRyxLQUFLLENBQUNaLDhFQUF1QixDQUFDTSxLQUFLO1lBRXhEUCxpREFBZ0IsQ0FBQyxDQUFDO2dCQUFDaUIsR0FBRyxFQUFFSixZQUFZLENBQUNLLEdBQUc7WUFBQyxDQUFDLEVBQUUsUUFBUSxDQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRSxDQUFDO2dCQUNoRSxFQUFFLEVBQUVELEdBQUcsSUFBSUMsSUFBSSxLQUFLLElBQUksRUFBRSxDQUFDO29CQUN6QmQsR0FBRyxDQUFDRSxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQzt3QkFDcEJDLEtBQUssRUFBRSxDQUFDOzRCQUNORixNQUFNLEVBQUUsR0FBRzs0QkFDWEcsT0FBTyxFQUFFLENBQTJDO3dCQUN0RCxDQUFDO29CQUNILENBQUM7Z0JBQ0gsQ0FBQztnQkFFREwsR0FBRyxDQUFDRSxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztvQkFDcEJZLElBQUksRUFBRSxDQUFDO3dCQUNMRCxJQUFJLEVBQUUsQ0FBQzs0QkFDTEUsUUFBUSxFQUFFRixJQUFJLENBQUNFLFFBQVE7NEJBQ3ZCQyxLQUFLLEVBQUVILElBQUksQ0FBQ0csS0FBSzt3QkFDbkIsQ0FBQzt3QkFDREMsRUFBRSxFQUFFWCxZQUFZLENBQUNLLEdBQUc7d0JBQ3BCTyxLQUFLLEVBQUVaLFlBQVksQ0FBQ1ksS0FBSztvQkFDM0IsQ0FBQztnQkFDSCxDQUFDO1lBQ0gsQ0FBQztRQUVILENBQUMsQ0FBQyxLQUFLLEVBQUNOLEdBQUcsRUFBRSxDQUFDO1lBQ1piLEdBQUcsQ0FBQ0UsTUFBTSxDQUFDLEdBQUcsRUFBRUMsSUFBSSxDQUFDLENBQUM7Z0JBQ2xCRCxNQUFNLEVBQUUsR0FBRztnQkFDWEcsT0FBTyxFQUFFLENBQXVFO1lBQ3BGLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztBQUNILENBQUM7QUFFRCxLQUFLLENBQUNlLFlBQVksR0FBRyxDQUFDO0lBQ3BCQyxHQUFHLEVBQUV4QixpQkFBaUIsQ0FBQ0MsVUFBVTtJQUNqQ3dCLE9BQU8sR0FBR0MsQ0FBQyxFQUFFdkIsR0FBRyxHQUFLQSxHQUFHLENBQUN3QixJQUFJLENBQUMsQ0FBSTtBQUNwQyxDQUFDO0FBRUQsRUFrQkc7SUFFRCxFQUFFLEVBQUVKO0lBRUpwQixHQUFHLENBQUNFLE1BQU0sQ0FBQztRQUNUQTtRQUNBRyxPQUFPLEVBQUUsQ0FBVztJQUN0QixDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2N1cnNvMDMtbmV4dGpzLWJhY2svLi9wYWdlcy9hcGkvc2Vzc2lvbi5qcz9kMGYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vZGInO1xyXG5pbXBvcnQgeyBhdXRoU2VydmljZSB9IGZyb20gJy4uLy4uL3NyYy9zZXJ2aWNlcy9hdXRoU2VydmljZSc7XHJcbmltcG9ydCB7IGdldFRva2VuRnJvbUhlYWRlcnMgfSBmcm9tICcuLi8uLi9zcmMvdXRpbHMvZ2V0VG9rZW5Gcm9tSGVhZGVycyc7XHJcblxyXG5jb25zdCBzZXNzaW9uQ29udHJvbGxlciA9IHtcclxuICBhc3luYyBnZXRTZXNzaW9uKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCB0b2tlbiA9IGdldFRva2VuRnJvbUhlYWRlcnMocmVxKTtcclxuXHJcbiAgICBpZighdG9rZW4pIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiB7IHN0YXR1czogNDAxLCBtZXNzYWdlOiAnWW91IGRvblxcJ3QgaGF2ZSBjcmVkZW50aWFscycgfSB9KTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBhdXRoU2VydmljZS52YWxpZGF0ZUFjY2Vzc1Rva2VuKHRva2VuKTtcclxuICAgICAgY29uc3QgZGVjb2RlZFRva2VuID0gYXdhaXQgYXV0aFNlcnZpY2UuZGVjb2RlVG9rZW4odG9rZW4pO1xyXG5cclxuICAgICAgZGIudXNlcnMuZmluZE9uZSh7IF9pZDogZGVjb2RlZFRva2VuLnN1YiB9LCBmdW5jdGlvbiAoZXJyLCB1c2VyKSB7XHJcbiAgICAgICAgaWYgKGVyciB8fCB1c2VyID09PSBudWxsKSB7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7XHJcbiAgICAgICAgICAgIGVycm9yOiB7XHJcbiAgICAgICAgICAgICAgc3RhdHVzOiA0MDEsXHJcbiAgICAgICAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgYWNjZXNzIHRva2VuLCBwbGVhc2UgbG9naW4gYWdhaW4uJyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgIHVzZXI6IHtcclxuICAgICAgICAgICAgICB1c2VybmFtZTogdXNlci51c2VybmFtZSxcclxuICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaWQ6IGRlY29kZWRUb2tlbi5zdWIsXHJcbiAgICAgICAgICAgIHJvbGVzOiBkZWNvZGVkVG9rZW4ucm9sZXMsXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0gY2F0Y2goZXJyKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcclxuICAgICAgICAgIHN0YXR1czogNDAxLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ1lvdXIgYWNjZXNzIHRva2VuIGlzIG5vdCB2YWxpZCwgc28geW91IGFyZSBub3QgYWJsZSB0byBnZXQgYSBzZXNzaW9uLicsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcbn07XHJcblxyXG5jb25zdCBjb250cm9sbGVyQnkgPSB7XHJcbiAgR0VUOiBzZXNzaW9uQ29udHJvbGxlci5nZXRTZXNzaW9uLFxyXG4gIE9QVElPTlM6IChfLCByZXMpID0+IHJlcy5zZW5kKCdPSycpLFxyXG59XHJcblxyXG4vKipcclxuICogQHN3YWdnZXJcclxuICogL2FwaS9zZXNzaW9uOlxyXG4gKiAgIGdldDpcclxuICogICAgIHN1bW1hcnk6IFJldHVybnMgYSBzZXNzaW9uIGZvciBvbmUgc3BlY2lmaWMgdXNlclxyXG4gKiAgICAgcGFyYW1ldGVyczogXHJcbiAqICAgICAgICAtIGluOiBoZWFkZXJcclxuICogICAgICAgICAgbmFtZTogeC1hdXRob3JpemF0aW9uXHJcbiAqICAgICAgICAgIHNjaGVtYTpcclxuICogICAgICAgICAgICB0eXBlOiBzdHJpbmdcclxuICogICAgICAgICAgICBkZXNjcmlwdGlvbjogWW91IGhhdmUgdG8gbG9naW4gZmlyc3QgdG8gZ2V0IGEgc2Vzc2lvbi5cclxuICogICAgICAgICAgICBkZWZhdWx0OiBhY2Nlc3NfdG9rZW5cclxuICogICAgICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICogICAgIHJlc3BvbnNlczpcclxuICogICAgICAgMjAwOlxyXG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBTZXNzaW9uIHJldHVybmVkIHdpdGggc3VjY2Vzc1xyXG4gKiAgICAgICA0MDE6XHJcbiAqICAgICAgICAgZGVzY3JpcHRpb246IFlvdSBhcmUgbm90IGF1dGhvcml6ZWQgdG8gZ2V0IGEgc2Vzc2lvblxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaGFuZGxlKHJlcSwgcmVzKSB7XHJcbiAgaWYgKGNvbnRyb2xsZXJCeVtyZXEubWV0aG9kXSkgcmV0dXJuIGNvbnRyb2xsZXJCeVtyZXEubWV0aG9kXShyZXEsIHJlcyk7XHJcblxyXG4gIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgIHN0YXR1czogNDA0LFxyXG4gICAgbWVzc2FnZTogJ05vdCBGb3VuZCdcclxuICB9KTtcclxufVxyXG4iXSwibmFtZXMiOlsiZGIiLCJhdXRoU2VydmljZSIsImdldFRva2VuRnJvbUhlYWRlcnMiLCJzZXNzaW9uQ29udHJvbGxlciIsImdldFNlc3Npb24iLCJyZXEiLCJyZXMiLCJ0b2tlbiIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsIm1lc3NhZ2UiLCJ2YWxpZGF0ZUFjY2Vzc1Rva2VuIiwiZGVjb2RlZFRva2VuIiwiZGVjb2RlVG9rZW4iLCJ1c2VycyIsImZpbmRPbmUiLCJfaWQiLCJzdWIiLCJlcnIiLCJ1c2VyIiwiZGF0YSIsInVzZXJuYW1lIiwiZW1haWwiLCJpZCIsInJvbGVzIiwiY29udHJvbGxlckJ5IiwiR0VUIiwiT1BUSU9OUyIsIl8iLCJzZW5kIiwiaGFuZGxlIiwibWV0aG9kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/session.js\n");

/***/ }),

/***/ "(api)/./src/services/authService.js":
/*!*************************************!*\
  !*** ./src/services/authService.js ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"authService\": () => (/* binding */ authService)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_getTokenFromHeaders__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/getTokenFromHeaders */ \"(api)/./src/utils/getTokenFromHeaders.js\");\n\n\nconst ACCESSTOKEN_SECRET = process.env.ACCESSTOKEN_SECRET;\nconst ACCESSTOKEN_EXPIRATION = '3s';\nconst REFRESHTOKEN_SECRET = process.env.REFRESHTOKEN_SECRET;\nconst REFRESHTOKEN_EXPIRATION = '7d';\nconst authService = {\n    async generateAccessToken (userId) {\n        return await jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign({\n            roles: [\n                'user'\n            ]\n        }, ACCESSTOKEN_SECRET, {\n            subject: userId,\n            expiresIn: ACCESSTOKEN_EXPIRATION\n        });\n    },\n    async validateAccessToken (accessToken) {\n        return await jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(accessToken, ACCESSTOKEN_SECRET);\n    },\n    async isAuthenticated (req) {\n        const token = (0,_utils_getTokenFromHeaders__WEBPACK_IMPORTED_MODULE_1__.getTokenFromHeaders)(req);\n        try {\n            await authService.validateAccessToken(token);\n            return true;\n        } catch (err) {\n            return false;\n        }\n    },\n    async generateRefreshToken (userId) {\n        return await jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign({}, REFRESHTOKEN_SECRET, {\n            subject: userId,\n            expiresIn: REFRESHTOKEN_EXPIRATION\n        });\n    },\n    async validateRefreshToken (refreshToken) {\n        return await jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(refreshToken, REFRESHTOKEN_SECRET);\n    },\n    async decodeToken (token) {\n        return await jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().decode(token);\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvc2VydmljZXMvYXV0aFNlcnZpY2UuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE4QjtBQUNvQztBQUVsRSxLQUFLLENBQUNFLGtCQUFrQixHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0Ysa0JBQWtCO0FBQ3pELEtBQUssQ0FBQ0csc0JBQXNCLEdBQUcsQ0FBSTtBQUNuQyxLQUFLLENBQUNDLG1CQUFtQixHQUFHSCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0UsbUJBQW1CO0FBQzNELEtBQUssQ0FBQ0MsdUJBQXVCLEdBQUcsQ0FBSTtBQUc3QixLQUFLLENBQUNDLFdBQVcsR0FBRyxDQUFDO1VBQ2xCQyxtQkFBbUIsRUFBQ0MsTUFBTSxFQUFFLENBQUM7UUFDL0IsTUFBTSxDQUFDLEtBQUssQ0FBQ1Ysd0RBQVEsQ0FDakIsQ0FBQztZQUFDWSxLQUFLLEVBQUUsQ0FBQztnQkFBQSxDQUFNO1lBQUEsQ0FBQztRQUFDLENBQUMsRUFDbkJWLGtCQUFrQixFQUNsQixDQUFDO1lBQUNXLE9BQU8sRUFBRUgsTUFBTTtZQUFFSSxTQUFTLEVBQUVULHNCQUFzQjtRQUFDLENBQUM7SUFFOUQsQ0FBQztVQUNLVSxtQkFBbUIsRUFBQ0MsV0FBVyxFQUFFLENBQUM7UUFDcEMsTUFBTSxDQUFDLEtBQUssQ0FBQ2hCLDBEQUFVLENBQUNnQixXQUFXLEVBQUVkLGtCQUFrQjtJQUMzRCxDQUFDO1VBQ0tnQixlQUFlLEVBQUNDLEdBQUcsRUFBRSxDQUFDO1FBQ3hCLEtBQUssQ0FBQ0MsS0FBSyxHQUFHbkIsK0VBQW1CLENBQUNrQixHQUFHO1FBRXJDLEdBQUcsQ0FBQyxDQUFDO1lBQ0QsS0FBSyxDQUFDWCxXQUFXLENBQUNPLG1CQUFtQixDQUFDSyxLQUFLO1lBQzNDLE1BQU0sQ0FBQyxJQUFJO1FBQ2YsQ0FBQyxDQUFDLEtBQUssRUFBRUMsR0FBRyxFQUFFLENBQUM7WUFDWCxNQUFNLENBQUMsS0FBSztRQUNoQixDQUFDO0lBQ0wsQ0FBQztVQUNLQyxvQkFBb0IsRUFBQ1osTUFBTSxFQUFFLENBQUM7UUFDaEMsTUFBTSxDQUFDLEtBQUssQ0FBQ1Ysd0RBQVEsQ0FDakIsQ0FBQyxDQUFDLEVBQ0ZNLG1CQUFtQixFQUNuQixDQUFDO1lBQUNPLE9BQU8sRUFBRUgsTUFBTTtZQUFFSSxTQUFTLEVBQUVQLHVCQUF1QjtRQUFDLENBQUM7SUFFL0QsQ0FBQztVQUNLZ0Isb0JBQW9CLEVBQUNDLFlBQVksRUFBRSxDQUFDO1FBQ3RDLE1BQU0sQ0FBQyxLQUFLLENBQUN4QiwwREFBVSxDQUFDd0IsWUFBWSxFQUFFbEIsbUJBQW1CO0lBQzdELENBQUM7VUFDS21CLFdBQVcsRUFBQ0wsS0FBSyxFQUFFLENBQUM7UUFDdEIsTUFBTSxDQUFDLEtBQUssQ0FBQ3BCLDBEQUFVLENBQUNvQixLQUFLO0lBQ2pDLENBQUM7QUFDTCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY3Vyc28wMy1uZXh0anMtYmFjay8uL3NyYy9zZXJ2aWNlcy9hdXRoU2VydmljZS5qcz9jYzQ2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcclxuaW1wb3J0IHsgZ2V0VG9rZW5Gcm9tSGVhZGVycyB9IGZyb20gJy4uL3V0aWxzL2dldFRva2VuRnJvbUhlYWRlcnMnO1xyXG5cclxuY29uc3QgQUNDRVNTVE9LRU5fU0VDUkVUID0gcHJvY2Vzcy5lbnYuQUNDRVNTVE9LRU5fU0VDUkVUO1xyXG5jb25zdCBBQ0NFU1NUT0tFTl9FWFBJUkFUSU9OID0gJzNzJztcclxuY29uc3QgUkVGUkVTSFRPS0VOX1NFQ1JFVCA9IHByb2Nlc3MuZW52LlJFRlJFU0hUT0tFTl9TRUNSRVQ7XHJcbmNvbnN0IFJFRlJFU0hUT0tFTl9FWFBJUkFUSU9OID0gJzdkJztcclxuXHJcblxyXG5leHBvcnQgY29uc3QgYXV0aFNlcnZpY2UgPSB7XHJcbiAgICBhc3luYyBnZW5lcmF0ZUFjY2Vzc1Rva2VuKHVzZXJJZCkge1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBqd3Quc2lnbihcclxuICAgICAgICAgICAgeyByb2xlczogWyd1c2VyJ10gfSxcclxuICAgICAgICAgICAgQUNDRVNTVE9LRU5fU0VDUkVULFxyXG4gICAgICAgICAgICB7IHN1YmplY3Q6IHVzZXJJZCwgZXhwaXJlc0luOiBBQ0NFU1NUT0tFTl9FWFBJUkFUSU9OIH1cclxuICAgICAgICApO1xyXG4gICAgfSxcclxuICAgIGFzeW5jIHZhbGlkYXRlQWNjZXNzVG9rZW4oYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgand0LnZlcmlmeShhY2Nlc3NUb2tlbiwgQUNDRVNTVE9LRU5fU0VDUkVUKTtcclxuICAgIH0sXHJcbiAgICBhc3luYyBpc0F1dGhlbnRpY2F0ZWQocmVxKSB7XHJcbiAgICAgICAgY29uc3QgdG9rZW4gPSBnZXRUb2tlbkZyb21IZWFkZXJzKHJlcSk7XHJcbiAgICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCBhdXRoU2VydmljZS52YWxpZGF0ZUFjY2Vzc1Rva2VuKHRva2VuKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7ICAgXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgYXN5bmMgZ2VuZXJhdGVSZWZyZXNoVG9rZW4odXNlcklkKSB7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IGp3dC5zaWduKFxyXG4gICAgICAgICAgICB7fSxcclxuICAgICAgICAgICAgUkVGUkVTSFRPS0VOX1NFQ1JFVCxcclxuICAgICAgICAgICAgeyBzdWJqZWN0OiB1c2VySWQsIGV4cGlyZXNJbjogUkVGUkVTSFRPS0VOX0VYUElSQVRJT04gfVxyXG4gICAgICAgICk7XHJcbiAgICB9LFxyXG4gICAgYXN5bmMgdmFsaWRhdGVSZWZyZXNoVG9rZW4ocmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IGp3dC52ZXJpZnkocmVmcmVzaFRva2VuLCBSRUZSRVNIVE9LRU5fU0VDUkVUKTtcclxuICAgIH0sXHJcbiAgICBhc3luYyBkZWNvZGVUb2tlbih0b2tlbikge1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBqd3QuZGVjb2RlKHRva2VuKTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiand0IiwiZ2V0VG9rZW5Gcm9tSGVhZGVycyIsIkFDQ0VTU1RPS0VOX1NFQ1JFVCIsInByb2Nlc3MiLCJlbnYiLCJBQ0NFU1NUT0tFTl9FWFBJUkFUSU9OIiwiUkVGUkVTSFRPS0VOX1NFQ1JFVCIsIlJFRlJFU0hUT0tFTl9FWFBJUkFUSU9OIiwiYXV0aFNlcnZpY2UiLCJnZW5lcmF0ZUFjY2Vzc1Rva2VuIiwidXNlcklkIiwic2lnbiIsInJvbGVzIiwic3ViamVjdCIsImV4cGlyZXNJbiIsInZhbGlkYXRlQWNjZXNzVG9rZW4iLCJhY2Nlc3NUb2tlbiIsInZlcmlmeSIsImlzQXV0aGVudGljYXRlZCIsInJlcSIsInRva2VuIiwiZXJyIiwiZ2VuZXJhdGVSZWZyZXNoVG9rZW4iLCJ2YWxpZGF0ZVJlZnJlc2hUb2tlbiIsInJlZnJlc2hUb2tlbiIsImRlY29kZVRva2VuIiwiZGVjb2RlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/services/authService.js\n");

/***/ }),

/***/ "(api)/./src/utils/getTokenFromHeaders.js":
/*!******************************************!*\
  !*** ./src/utils/getTokenFromHeaders.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"getTokenFromHeaders\": () => (/* binding */ getTokenFromHeaders)\n/* harmony export */ });\nfunction getTokenFromHeaders(req) {\n    const authHeader = req.headers['x-authorization'] || req.headers['authorization'] || '';\n    const token = authHeader === null || authHeader === void 0 ? void 0 : authHeader.split(' ')[(authHeader === null || authHeader === void 0 ? void 0 : authHeader.split(' ').length) - 1];\n    return token;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvZ2V0VG9rZW5Gcm9tSGVhZGVycy5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU8sU0FBU0EsbUJBQW1CLENBQUNDLEdBQUcsRUFBRSxDQUFDO0lBQ3hDLEtBQUssQ0FBQ0MsVUFBVSxHQUFHRCxHQUFHLENBQUNFLE9BQU8sQ0FBQyxDQUFpQixxQkFBS0YsR0FBRyxDQUFDRSxPQUFPLENBQUMsQ0FBZSxtQkFBSyxDQUFFO0lBQ3ZGLEtBQUssQ0FBQ0MsS0FBSyxHQUFHRixVQUFVLGFBQVZBLFVBQVUsS0FBVkEsSUFBSSxDQUFKQSxDQUFpQixHQUFqQkEsSUFBSSxDQUFKQSxDQUFpQixHQUFqQkEsVUFBVSxDQUFFRyxLQUFLLENBQUMsQ0FBRyxLQUFFSCxVQUFVLGFBQVZBLFVBQVUsS0FBVkEsSUFBSSxDQUFKQSxDQUFpQixHQUFqQkEsSUFBSSxDQUFKQSxDQUFpQixHQUFqQkEsVUFBVSxDQUFFRyxLQUFLLENBQUMsQ0FBRyxJQUFFQyxNQUFNLElBQUcsQ0FBQztJQUN0RSxNQUFNLENBQUNGLEtBQUs7QUFDZCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY3Vyc28wMy1uZXh0anMtYmFjay8uL3NyYy91dGlscy9nZXRUb2tlbkZyb21IZWFkZXJzLmpzP2E0MGMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGdldFRva2VuRnJvbUhlYWRlcnMocmVxKSB7XHJcbiAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzWyd4LWF1dGhvcml6YXRpb24nXSB8fCByZXEuaGVhZGVyc1snYXV0aG9yaXphdGlvbiddIHx8ICcnO1xyXG4gIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlcj8uc3BsaXQoJyAnKVthdXRoSGVhZGVyPy5zcGxpdCgnICcpLmxlbmd0aCAtIDFdO1xyXG4gIHJldHVybiB0b2tlbjtcclxufVxyXG4iXSwibmFtZXMiOlsiZ2V0VG9rZW5Gcm9tSGVhZGVycyIsInJlcSIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwidG9rZW4iLCJzcGxpdCIsImxlbmd0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/utils/getTokenFromHeaders.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/session.js"));
module.exports = __webpack_exports__;

})();